-- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –≤–µ—Å —É—Ä–æ–≤–Ω—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ lev_id —á–µ—Ä–µ–∑ view_study_level_mapped
-- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ quiz_weight, –µ—Å–ª–∏ –∏–∑–≤–µ—Å—Ç–µ–Ω —Ç–æ–ª—å–∫–æ lev_id (–±–µ–∑ —Å–ª–æ–≤)

CREATE OR REPLACE VIEW view_quiz_weight_by_group AS
SELECT
  vslm.lev_id,                           -- ID —É—Ä–æ–≤–Ω—è –∏–∑ study_level (–Ω–∞–ø—Ä–∏–º–µ—Ä, 1 ‚Äî –Ω–∞—á–∞–ª—å–Ω—ã–π)
  MAX(sl.weight_value) AS weight_value  -- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –≤–µ—Å, –ø—Ä–∏—Å–≤–æ–µ–Ω–Ω—ã–π —ç—Ç–æ–º—É —É—Ä–æ–≤–Ω—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, 1.3)
FROM view_study_level_mapped vslm
JOIN study_levels sl
  ON sl.level_word = vslm.level_word     -- –°–≤—è–∑—å –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é —É—Ä–æ–≤–Ω—è, –ø—Ä–∏–≤–æ–¥–∏–º –∫ –æ–±—â–µ–º—É –≤–∏–¥—É
GROUP BY vslm.lev_id                     -- –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ —É—Ä–æ–≤–Ω—é –∏–∑ study_level
ORDER BY vslm.lev_id;                    -- –î–ª—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

-- üìå –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≤ –ª–æ–≥–∏–∫–µ:
-- –∫–æ–≥–¥–∞ score_quiz < 1.0 –∏ –Ω–µ—Ç —Å–º—ã—Å–ª–∞ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—Ç—å –≤–µ—Å –ø–æ —Å–ª–æ–≤–∞–º
-- –≤ –æ–±–æ–±—â—ë–Ω–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–µ –±–µ–∑ –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–ª–æ–≤