
# üìä Esp2Rus_bot ‚Äî –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫ v2

## üöÄ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫ v2 –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –±–æ–ª–µ–µ —Ç–æ—á–Ω–æ–≥–æ —Ä–∞—Å—á—ë—Ç–∞ –º–µ—Ç—Ä–∏–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
- `quiz_weight` ‚Äî –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –≤–µ—Å –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã –ø–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ —Å–ª–æ–≤
- `client_rating` ‚Äî –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥ –∫–ª–∏–µ–Ω—Ç–∞
- `level_id_current` ‚Äî (–≤ –±—É–¥—É—â–µ–º) —Ç–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ CEFR

## üß™ –≠—Ç–∞–ø 2: Staging

### ‚úÖ –í–∫–ª—é—á–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Å—Ç–µ–∫–∞
–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤ `core/config.py`:
```python
USE_ANALYTICS_V2 = True
```

### üß± –§–∞–π–ª –ª–æ–≥–∏–∫–∏
–ó–∞–º–µ–Ω–∏—Ç–µ:
```
analytics.py ‚Üê analytics_v2_logging_fixed.py
```

### üìÇ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
–í—Å–µ –º–µ—Ç—Ä–∏–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤:
```
data/logs/analytics_debug/quiz_weight_v2.log
```
**–ü—Ä–∏–º–µ—Ä –∑–∞–ø–∏—Å–∏:**
```
2025-05-09 14:30:24: client_id=1, quiz_weight=1.1, client_rating=58.03
```

### üìå –ü—Ä–æ–≤–µ—Ä–∫–∏:
- `client_activity_log` ‚Äî –∑–∞–ø–∏—Å—å —Å–µ—Å—Å–∏–∏
- `client_analytics` ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏—Ç–æ–≥–æ–≤—ã—Ö –º–µ—Ç—Ä–∏–∫
- `quiz_weight` –ø–µ—Ä–µ—Å—á–∏—Ç–∞–Ω –ø–æ `view_word_weight`
- `client_rating` –Ω–∞–∫–∞–ø–ª–∏–≤–∞–µ—Ç —Å—É–º–º—É `quiz_weight` –∑–∞ –≤—Å–µ –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã

---

## üõë –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–∫–∞—Ç–∞
–§–ª–∞–≥ `USE_ANALYTICS_V2 = False` –≤–µ—Ä–Ω—ë—Ç —Å—Ç–∞—Ä—É—é –∞–Ω–∞–ª–∏—Ç–∏–∫—É.

## üîú –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ:
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á—ë—Ç `level_id_current`
- –§–æ–Ω–æ–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è `sync_client_analytics.py`
- –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π cron + –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `cron_events`
