## ‚öôÔ∏è –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞: –ª–æ–∫–∞–ª—å–Ω–æ –∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

> –í–ê–ñ–ù–û: –ø—Ä–æ–µ–∫—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∑–∞–ø—É—Å–∫ **–ª–æ–∫–∞–ª—å–Ω–æ** (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏) –∏ –Ω–∞ **—Å–µ—Ä–≤–µ—Ä–µ/VPS** (–≤ Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ). –ù–∏–∂–µ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ **–Ω—É–∂–Ω–æ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –≤—Ä—É—á–Ω—É—é** –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã.

---

### üìç 1. –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `DB_HOST` –≤ `.env`

- **–õ–æ–∫–∞–ª—å–Ω–æ**:
  ```env
  DB_HOST=localhost
  ```

- **–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ (–≤ Docker)**:
  ```env
  DB_HOST=db  # –∏–º—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Å PostgreSQL –≤ docker-compose.yml
  ```

---

### üìç 2. –õ–æ–∫–∞–ª—å–Ω—ã–π –∏–º–ø–æ—Ä—Ç –≤—Ä—É—á–Ω—É—é (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –ø—Ä–æ–¥–∞–∫—à–Ω–µ)

- –°–∫—Ä–∏–ø—Ç—ã `import_words.py`, `run_import.py` ‚Äî **–Ω—É–∂–Ω—ã —Ç–æ–ª—å–∫–æ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞**.
- –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –≤–µ—Å—å –∏–º–ø–æ—Ä—Ç CSV –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è **—á–µ—Ä–µ–∑ Telegram-–±–æ—Ç–∞**.

---

### üìç 3. –ü—Ä–∏–º–µ—Ä `.env` —Ñ–∞–π–ª–∞ –¥–ª—è –õ–û–ö–ê–õ–¨–ù–û–ô —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

```env
# === Telegram Bot ===
BOT_TOKEN=your_bot_token

# === PostgreSQL ===
DB_USER=postgres
DB_PASSWORD=your_password
DB_NAME=esp2rus
DB_HOST=localhost
DB_PORT=5432

ADMIN_IDS=123456789
```

---

### üìç 4. –ü—Ä–∏–º–µ—Ä `.env` —Ñ–∞–π–ª–∞ –¥–ª—è –ü–†–û–î–ê–ö–®–ù–ê (Docker)

```env
# === Telegram Bot ===
BOT_TOKEN=your_bot_token

# === PostgreSQL ===
DB_USER=postgres
DB_PASSWORD=your_password
DB_NAME=esp2rus
DB_HOST=db
DB_PORT=5432

ADMIN_IDS=123456789
```

---

### üìç 5. –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏ –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –º–µ–∂–¥—É —Ä–µ–∂–∏–º–∞–º–∏

| –û—à–∏–±–∫–∞ | –í–æ–∑–º–æ–∂–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞ |
|--------|--------------------|
| `could not translate host name "db"` | –£–∫–∞–∑–∞–Ω `DB_HOST=db` –ø—Ä–∏ –ª–æ–∫–∞–ª—å–Ω–æ–º –∑–∞–ø—É—Å–∫–µ (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å `localhost`) |
| `connection refused` | PostgreSQL –Ω–µ –∑–∞–ø—É—â–µ–Ω –∏–ª–∏ –ø–æ—Ä—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω |
| `SyntaxError: passing state=` | –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å—Ç–∞—Ä—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã aiogram (2.x —Å–∏–Ω—Ç–∞–∫—Å–∏—Å), –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å 3.x |
| `file not found` | –§–∞–π–ª `.env` –Ω–µ —Å–æ–∑–¥–∞–Ω –∏–ª–∏ –Ω–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –∏–∑ `.env.example` |

---

### 6. –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ–π –∏ —Å–µ—Ä–≤–µ—Ä–Ω–æ–π —Å—Ä–µ–¥—ã

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è aiogram –≤–µ—Ä—Å–∏–∏ 3.x.
- –í–º–µ—Å—Ç–æ `state="..."` –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `StateFilter(...)`.
- –§–∞–π–ª `.env` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω –æ—Ç–¥–µ–ª—å–Ω–æ –ø–æ–¥ –∫–∞–∂–¥—É—é —Å—Ä–µ–¥—É (–ª–æ–∫–∞–ª—å–Ω—É—é –∏ —Å–µ—Ä–≤–µ—Ä–Ω—É—é).

---

### üìç 7. –û—Ç–ª–∞–¥–∫–∞ –ø—Ä–æ–±–ª–µ–º

–ï—Å–ª–∏ –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ `/admin` –∏–ª–∏ `/cancel` –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –≤–∏–∫—Ç–æ—Ä–∏–Ω–∞:
- –£–±–µ–¥–∏—Å—å, —á—Ç–æ `@router.message(Command("cancel"))` –∏ `@router.message(Command("admin"))` –Ω–∞—Ö–æ–¥—è—Ç—Å—è **–≤—ã—à–µ** `@router.message(F.text)` –≤ —Ñ–∞–π–ª–µ `user_handlers.py`

–ï—Å–ª–∏ –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è CSV-—Ñ–∞–π–ª:
- –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ —Ö–µ–Ω–¥–ª–µ—Ä `@router.message(F.document)` –Ω–∞—Ö–æ–¥–∏—Ç—Å—è **–≤—ã—à–µ –≤—Å–µ—Ö –¥—Ä—É–≥–∏—Ö message-—Ö–µ–Ω–¥–ª–µ—Ä–æ–≤**
- –£–±–µ–¥–∏—Å—å, —á—Ç–æ `admin_handlers.py` –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –≤ `main.py`

–ï—Å–ª–∏ –Ω–µ—Ç —Ä–µ–∞–∫—Ü–∏–∏ –Ω–∞ `/start`:
- –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ –±–æ—Ç –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –∫–∞–∫–æ–º-–ª–∏–±–æ `FSMContext`. –ö–æ–º–∞–Ω–¥–∞ `/cancel` –¥–æ–ª–∂–Ω–∞ –æ—á–∏—â–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ.
